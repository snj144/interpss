When injecting reactive power, Vsh should larger than Vi, but it is not the case in current code.
Try Vis = 0.7 and Vis = 1.15 as the example.